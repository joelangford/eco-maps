(()=>{"use strict";const e=JSON.parse('{"r":[{"username":"joe","password":"test","firstname":"Joe","surname":"Langford","avatarUrl":"https://joelangford.com/img/portrait.png","jobTitle":"Web Developer"},{"username":"homer","password":"test","firstname":"Homer","surname":"Simpson","avatarUrl":"https://www.pngkey.com/png/detail/224-2240291_homer-simpson-face-render-png-by-8scorpion-d6mtcmo.png","jobTitle":"Nuclear safety inspector"},{"username":"mac","password":"test","firstname":"Mac","surname":"McDonald","avatarUrl":"http://images3.wikia.nocookie.net/__cb20110812033803/itsalwayssunny/images/0/0d/Mac_(7).jpg","jobTitle":"Bodyguard"}]}'),t=(t,i)=>{const r=e.r.find((e=>e.username===t));return(e=>{for(let t in e)localStorage.setItem(t,e[t])})(r),r.password===i},i=e=>{const t=document.getElementById("login"),i=document.getElementById("map-page");t.style.display="none",i.style.display="flex",e()};var r=function e(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;var r,s,o;if(Array.isArray(t)){if((r=t.length)!=i.length)return!1;for(s=r;0!=s--;)if(!e(t[s],i[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(i).length)return!1;for(s=r;0!=s--;)if(!Object.prototype.hasOwnProperty.call(i,o[s]))return!1;for(s=r;0!=s--;){var a=o[s];if(!e(t[a],i[a]))return!1}return!0}return t!=t&&i!=i};const s="__googleMapsScriptId";var o;!function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"}(o||(o={}));class a{constructor({apiKey:e,authReferrerPolicy:t,channel:i,client:o,id:n=s,language:l,libraries:c=[],mapIds:h,nonce:g,region:d,retries:p=3,url:u="https://maps.googleapis.com/maps/api/js",version:m}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=t,this.channel=i,this.client=o,this.id=n||s,this.language=l,this.libraries=c,this.mapIds=h,this.nonce=g,this.region=d,this.retries=p,this.url=u,this.version=m,a.instance){if(!r(this.options,a.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(a.instance.options)}`);return a.instance}a.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?o.FAILURE:this.done?o.SUCCESS:this.loading?o.LOADING:o.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+=`?callback=${this.CALLBACK}`,this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise(((e,t)=>{this.loadCallback((i=>{i?t(i.error):e(window.google)}))}))}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){if(document.getElementById(this.id))return void this.callback();const e=this.createUrl(),t=document.createElement("script");t.id=this.id,t.type="text/javascript",t.src=e,t.onerror=this.loadErrorCallback.bind(this),t.defer=!0,t.async=!0,this.nonce&&(t.nonce=this.nonce),document.head.appendChild(t)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const e=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${e} ms.`),setTimeout((()=>{this.deleteScript(),this.setScript()}),e)}else this.onerrorEvent=e,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach((e=>{e(this.onerrorEvent)})),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}const n=(e,t,i)=>{e.route({origin:i.origin,destination:i.destination,travelMode:google.maps.TravelMode[i.method]}).then((e=>{var i=e.routes[0].overview_path,r=[];i.forEach((e=>{r.push({lat:parseFloat(e.lat()),lng:parseFloat(e.lng())})})),((e,t)=>{let i=0;const r={path:"M393.043,206.632c-9.813,0-19.641,1.697-29.208,5.044l-1.996,0.698l-32.147-58.406v-25.365h38.517 c7.402,0,13.424-6.022,13.424-13.425s-6.021-13.425-13.424-13.425h-51.039c-7.401,0-13.424,6.022-13.424,13.425 c0,1.084,0.148,2.211,0.44,3.349l0.078,0.306v25.69H187.152l-9.644-21.476h27.897c7.009,0,12.71-5.703,12.71-12.714 c0-7.01-5.701-12.713-12.71-12.713h-95.083c-7.011,0-12.714,5.703-12.714,12.713c0,7.011,5.703,12.714,12.714,12.714h39.322 l8.49,19.248l-38.149,70.096l-2.007-0.703c-9.557-3.351-19.38-5.049-29.198-5.049C39.827,206.639,0,246.468,0,295.423 c0,48.953,39.827,88.779,88.78,88.779c43.436,0,80.206-31.113,87.434-73.98l0.351-2.086h37.787l0.724,0.688 c5.776,5.48,13.335,8.5,21.284,8.5c17.056,0,30.932-13.876,30.932-30.932c0-2.946-0.422-5.881-1.255-8.719l-0.293-0.998 l51.233-93.079l22.596,41.054l-1.652,1.312c-21.39,16.999-33.657,42.316-33.657,69.462c0,48.952,39.826,88.778,88.779,88.778 s88.78-39.826,88.78-88.778C481.823,246.464,441.996,206.632,393.043,206.632z M129.84,247.173l2.349,2.219 c8.702,8.213,14.881,18.647,17.867,30.177l0.811,3.127h-40.578L129.84,247.173z M150.056,311.265 c-7.254,27.965-32.451,47.496-61.274,47.496c-34.934,0-63.354-28.42-63.354-63.354s28.421-63.353,63.354-63.353 c5.101,0,10.373,0.686,15.672,2.039l3.128,0.8l-29.93,54.403c-0.076,0.199-0.158,0.396-0.259,0.59 c-0.208,0.43-0.363,0.803-0.488,1.164c-0.175,0.463-0.294,0.838-0.382,1.197c-0.099,0.373-0.169,0.73-0.239,1.193 c-0.085,0.504-0.126,0.924-0.131,1.293l-0.005,0.132c-0.012,0.169-0.034,0.339-0.06,0.51l-0.007,0.056l0.005,0.041 c0.02,0.144,0.036,0.285,0.045,0.426c0.028,0.504,0.081,0.981,0.145,1.453c0.054,0.344,0.116,0.729,0.214,1.114 c0.094,0.378,0.208,0.751,0.354,1.153c0.149,0.45,0.293,0.811,0.464,1.174c0.156,0.348,0.338,0.66,0.549,1.023l0.051,0.089 c0.215,0.377,0.407,0.674,0.611,0.944c0.229,0.313,0.479,0.619,0.814,0.994c0.263,0.285,0.534,0.586,0.834,0.86 c0.31,0.28,0.638,0.541,0.97,0.803c0.319,0.239,0.675,0.503,1.029,0.706l0.147,0.092c0.101,0.067,0.201,0.143,0.302,0.219 l0.092,0.067c0.202,0.064,0.4,0.148,0.598,0.255c0.341,0.166,0.741,0.334,1.105,0.459c0.461,0.17,0.852,0.293,1.258,0.398 c0.317,0.084,0.647,0.15,1.119,0.227c0.499,0.084,0.962,0.131,1.427,0.148c0.136-0.008,0.346,0.021,0.565,0.05l62.087,0.009 L150.056,311.265z M212.542,266.657c-3.338,4.023-5.611,8.865-6.574,13.998l-0.383,2.039h-29.02l-0.351-2.085 c-3.637-21.568-15.111-40.981-32.312-54.661l-1.651-1.313l29.183-53.023l42.102,93.848L212.542,266.657z M247.331,257.394 l-1.94-0.592c-2.246-0.686-4.594-1.11-6.979-1.268l-1.502-0.098l-38.342-85.497h96.908L247.331,257.394z M393.043,358.761 c-34.933,0-63.353-28.42-63.353-63.354c0-17.544,7.082-33.887,19.941-46.018l2.35-2.217l29.927,54.367 c2.227,4.061,6.499,6.58,11.15,6.58c2.17,0,4.229-0.529,6.122-1.575c2.977-1.635,5.133-4.331,6.076-7.593 c0.944-3.264,0.563-6.705-1.077-9.688l-29.925-54.372l3.126-0.8c5.291-1.354,10.564-2.04,15.678-2.04 c34.934,0,63.354,28.42,63.354,63.353C456.396,330.341,427.97,358.761,393.043,358.761z",fillColor:"black",fillOpacity:1,strokeWeight:0,rotation:0,scale:.075,anchor:new google.maps.Point(200,200)},s=new google.maps.Marker({position:e[i],map:t,icon:r}),o=new google.maps.Polyline({path:e,strokeColor:"teal",strokeOpacity:1,strokeWeight:3,map:t,visible:!1}),a=window.setInterval((function(){i++,i<e.length?s.setPosition(e[i]):clearInterval(a)}),500);google.maps.event.addListener(s,"click",(function(){o.getVisible()?o.setVisible(!1):o.setVisible(!0)}))})(r,t)})).catch((e=>window.alert("Directions request failed due to "+status)))},l=(e,t)=>{const i=((e,t)=>{const i=t/(e/3);switch(Math.floor(i)){case 3:return"full";case 2:return"busy";default:return"not-busy"}})(t.chargers,t.ocupationLevel),r=`\n    <div>\n      <h1>Charging Station</h1>\n      <h2 class=${i}>${i}</h2>\n      <div>${t.ocupationLevel}/${t.chargers} chargers in use</div>\n    </div>\n  `,s=new google.maps.InfoWindow({content:r}),o={path:"M420,320V65c0-35.841-29.159-65-65-65s-65,29.159-65,65v330c0,19.299-15.701,35-35,35s-35-15.701-35-35v-45h40V70h-30v190H30V70H0v280h190v45c0,35.841,29.159,65,65,65s65-29.159,65-65V65c0-19.299,15.701-35,35-35s35,15.701,35,35v255h-40v90h10v50h30v-50h30v50h30v-50h10v-90H420z M45,320c-8.284,0-15-6.716-15-15s6.716-15,15-15s15,6.716,15,15S53.284,320,45,320z",fillColor:"black",fillOpacity:1,strokeWeight:0,rotation:0,scale:.075,anchor:new google.maps.Point(200,200)},a=new google.maps.Marker({position:t.latLng,map:e,icon:o});a.addListener("click",(()=>{s.open({anchor:a,map:e,shouldFocus:!1})}))},c=JSON.parse('{"_":[{"origin":"Asda Tilehurst Superstore","destination":"Reading West Station","method":"BICYCLING"},{"origin":"The Hexagon, Reading","destination":"Reading Station","method":"BICYCLING"},{"origin":"The Oracle, Reading","destination":"Thames Lido, Reading","method":"BICYCLING"}]}'),h=JSON.parse('{"c":[{"latLng":{"lat":51.4521043,"lng":-0.9778538},"chargers":6,"ocupationLevel":4},{"latLng":{"lat":51.458367,"lng":-0.973669},"chargers":18,"ocupationLevel":18},{"latLng":{"lat":51.4530722,"lng":-0.9877452},"chargers":6,"ocupationLevel":0}]}'),g=new a({apiKey:"AIzaSyB6EQLQGwYWwD0JDQBDdotn-XTjUQmZmHM",version:"weekly",libraries:["directions"]});var d;d=()=>{g.load().then((e=>{const t=new e.maps.DirectionsService,i=new e.maps.Map(document.getElementById("map"),{zoom:14,center:{lat:51.4583674,lng:-.9736686}});c._.map((e=>{n(t,i,e)})),h.c.map((e=>{l(i,e)}))})).catch((e=>{console.log(e)})),(()=>{const e=document.getElementById("user"),t=localStorage.getItem("firstname"),i=localStorage.getItem("surname"),r=localStorage.getItem("avatarUrl"),s=((e,t,i,r)=>`\n    <img class="user-profile__avatar" src="${r}" alt="${e} ${t}'s avatar" />\n    <h1 class="user-profile__name">${e} ${t}</h1>\n    <h2 class="user-profile__job">${i}</h2>\n    `)(t,i,localStorage.getItem("jobTitle"),r);e.innerHTML=s,document.getElementById("logout").addEventListener("click",(()=>{localStorage.clear(),window.location.reload()}))})()},(()=>{const e=localStorage.getItem("username"),i=localStorage.getItem("password");return!(!e||!i)&&t(e,i)})()&&i(d),document.getElementById("login-form").addEventListener("submit",(e=>{e.preventDefault();const r=new FormData(e.target),s=Object.fromEntries(r);t(s.username,s.password)&&i(d)}))})();